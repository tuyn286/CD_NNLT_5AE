2025-05-13 18:07:04.161 INFO __main__:start:264 - Starting Pet Data Ingestion service
2025-05-13 18:07:04.215 INFO __main__:load_pet_data:58 - Loaded 5 pet records
2025-05-13 18:07:04.221 INFO __main__:ingest:199 - Initial run - Last processed timestamp: 0
2025-05-13 18:07:04.221 ERROR __main__:ingest:254 - Error during initial ingestion: 'DataIngrestion' object has no attribute 'filter_data_single_ad'
2025-05-13 18:07:04.221 ERROR __main__:ingest:257 - Full traceback:
Traceback (most recent call last):

  File "src\data_ingrestion\data_ingrestion.py", line 304, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x00000254F27E6D30>
    │       └ <function run at 0x00000254F2BE95E0>
    └ <module 'asyncio' from 'C:\\Users\\nguye\\miniconda3\\envs\\python_course\\lib\\asyncio\\__init__.py'>

  File "C:\Users\nguye\miniconda3\envs\python_course\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object main at 0x00000254960FD840>
           │    └ <function BaseEventLoop.run_until_complete at 0x00000254F4777D30>
           └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\nguye\miniconda3\envs\python_course\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x00000254F4877160>
    └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\nguye\miniconda3\envs\python_course\lib\asyncio\windows_events.py", line 316, in run_forever
    super().run_forever()

  File "C:\Users\nguye\miniconda3\envs\python_course\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000254F477B820>
    └ <ProactorEventLoop running=True closed=False debug=False>

  File "C:\Users\nguye\miniconda3\envs\python_course\lib\asyncio\base_events.py", line 1859, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000254F4712B80>
    └ <Handle <TaskWakeupMethWrapper object at 0x000002549610EDF0>(<Future finished result=None>)>

  File "C:\Users\nguye\miniconda3\envs\python_course\lib\asyncio\events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x000002549610EDF0>(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x000002549610EDF0>(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x000002549610EDF0>(<Future finished result=None>)>

  File "src\data_ingrestion\data_ingrestion.py", line 301, in main
    await service.start()
          │       └ <function DataIngrestion.start at 0x000002549612F4C0>
          └ <__main__.DataIngrestion object at 0x000002549610E970>

  File "src\data_ingrestion\data_ingrestion.py", line 267, in start
    await self.ingest(is_initial_run=True)
          │    └ <function DataIngrestion.ingest at 0x000002549612F430>
          └ <__main__.DataIngrestion object at 0x000002549610E970>

> File "src\data_ingrestion\data_ingrestion.py", line 223, in ingest
    filtered_item = self.filter_data_single_ad(ad_object) # Gọi hàm mới hoặc sửa filter_data
                    │                          └ {'ad_id': 167461938, 'list_id': 124945853, 'list_time': 1747121124000, 'state': 'accepted', 'type': 's', 'account_name': 'LÊ ...
                    └ <__main__.DataIngrestion object at 0x000002549610E970>

AttributeError: 'DataIngrestion' object has no attribute 'filter_data_single_ad'
